<!DOCTYPE html>
<html lang="es-VE">
<head>
    <meta charset="UTF-8"/>
    <!--<meta name="language" content="es-VE"/>-->
    <meta name="viewport" content="width=device-width, initial-scala1.0" />
    <meta name="author" content="Salomon Trujillo" />
    <meta name="description" content="Este es el juego Batalla Naval"/>
    <meta name="keywords" content="Batalla Naval, juego, taller"/>
    <meta name="robots" content="noindex, nofollow" />
    <link rel="icon" href="https://static3.depositphotos.com/1007664/237/v/450/depositphotos_2376836-stock-illustration-battle-ship.jpg" type="imag/png " sizes="16x16 32x32 64x64">
    <link rel="stylesheet" href="../estilos/style.css">
    <script src="../scripts/script.js"></script>
    <title>BatallaNaval | multijugador</title>
</head>
<body>
    <div class="principal-multijugador">
        <header>
            <hgroup>
                <h1>Batalla Naval</h1>
                <h2>¡Se un ganador!</h2>
            </hgroup>
            <nav class="opciones-navegación"> 
                <a href="index.html">INICIO</a>
                <a href="reglas.html">REGLAS</a>
                <a class="volver-btn" onclick="volverPagina()">VOLVER</a>
            </nav>
        </header>
        <main>
            <section id="opciones-multijugador">
                <a href="mecanicas-multijugador.html">Mecanica de Juego Multijugador</a>
                <a href="jugar-dos.html">Crear Partida contra otra Persona</a>
                <a href="jugar-tres.html">Crear Partida contra dos Personas</a>
                <a href="jugar-cuatro.html">Crear Partida contra tres Personas</a>
                <div class="unirse-a-juego">
                  <button id="join-game" class="server-operation">Unirse a un juego existente</button>
                  <input type="text" id="game-id" class="server-operation" placeholder="ID del juego" />
                </div>
            </section>
        </main>
        <footer>
            <h3>by: Ing.Salomón Trujillo | Program Web | Ucab</h3>
        </footer>
    </div>

    <script>

      const WEBSOCKET_SCHEME = 'ws';
      const WEBSOCKET_SERVER = 'batalla-naval.deno.dev';
      const WEBSOCKET_PORT = 80;
      const WEBSOCKET_URL = `${WEBSOCKET_SCHEME}://${WEBSOCKET_SERVER}:${WEBSOCKET_PORT}`;

      const socket = new WebSocket(WEBSOCKET_URL);

      socket.addEventListener('open', () => {

        console.log(`%cConectado al servidor en ${WEBSOCKET_URL}`,  'color: #99ff00');
      });

      socket.addEventListener('message', (event) => {

        const message = JSON.parse(event.data);

        console.log('%c<- %cMensaje recibido desde el servidor:', 'color: #99ff00', 'color: inherit', message);
      });

      socket.addEventListener('close', () => {
        console.log('%cSe ha cerrado la conexión con el servidor WebSocket', 'color: #ee0000');

        const buttons = document.getElementsByClassName('server-operation');

        [...buttons].forEach((button) => {
          button.disabled = true;
        });

        const closeButton = document.getElementById('close-connection');
        closeButton.parentNode.removeChild(closeButton);

      });

      //UNIRSE A JUEGO
      document.getElementById('join-game').addEventListener('click', () => {
        const gameId = document.getElementById('game-id').value;

        socket.send(JSON.stringify({ type: 'join', gameId }));
      });
      
    </script>
</body>
</html>